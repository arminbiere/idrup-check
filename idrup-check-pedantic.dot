digraph "idrup-check" {

  "start-of-file" [shape=box,color=darkgray,fontcolor=darkgray];
  "start-of-file" -> INTERACTION_HEADER [label=" ^ ",weight=2,color=darkgray,fontcolor=darkgray];

  "end-of-file" [shape=diamond,color=darkgray,fontcolor=darkgray];

  // INTERACTION_HEADER -> "end-of-file";
  // INTERACTION_INPUT -> "end-of-file";
   "end-of-file" -> INTERACTION_HEADER [label="$    ",dir=back,color=darkgray,style=invis];
   "end-of-file" -> INTERACTION_INPUT [label="$    ",dir=back,color=darkgray,fontcolor=darkgray];

  INTERACTION_HEADER [shape=box];
  INTERACTION_HEADER -> PROOF_INPUT [label=" i ",style=invis];
  INTERACTION_HEADER -> PROOF_QUERY [label=" q ",color=invis,fontsize=20,fontcolor=invis];
  INTERACTION_HEADER -> INTERACTION_INPUT [label=" p icnf ",weight=2];

  INTERACTION_INPUT [shape=box];
  INTERACTION_INPUT -> PROOF_INPUT [label=" i ",weight=2];
  INTERACTION_INPUT -> PROOF_QUERY [label=" q ",weight=2,color=orange3,fontsize=20,fontcolor=orange3];

  PROOF_INPUT -> INTERACTION_INPUT [label=" i ",weight=3];
  PROOF_INPUT -> PROOF_INPUT [label=" l | d "];

  PROOF_QUERY -> PROOF_CHECK [label=" q "];

  PROOF_CHECK [fontsize=20];
  PROOF_CHECK -> PROOF_CHECK [label=" l | d | r | w ",dir=back,fontsize=20];
  PROOF_CHECK -> INTERACTION_SATISFIABLE [label=" s SATISFIABLE "];
  PROOF_CHECK -> INTERACTION_UNSATISFIABLE [label=" s UNSATISFIABLE "];

  INTERACTION_UNSATISFIABLE [shape="box",label="INTERACTION_UNSATISFIABLE?"];
  INTERACTION_UNSATISFIABLE -> INTERACTION_UNSATISFIED [label=" s UNSATISFIABLE "];

  INTERACTION_SATISFIABLE [shape="box",label="INTERACTION_SATISFIABLE?"];
  INTERACTION_SATISFIABLE -> INTERACTION_SATISFIED [label=" s SATISFIABLE "];

  INTERACTION_SATISFIED [shape=box,label="INTERACTION_SATISFIED!"];
  INTERACTION_SATISFIED -> PROOF_VALUES [label=" v "];
  INTERACTION_SATISFIED -> PROOF_INPUT_OR_VALUES [label=" i ",color=invis,fontcolor=invis];
  INTERACTION_SATISFIED -> PROOF_QUERY_OR_VALUES [label=" q ", color=invis,fontsize=20,fontcolor=invis];
  INTERACTION_SATISFIED -> PROOF_VALUES_AND_END [label=" $ ",color=invis,fontcolor=invis];

  INTERACTION_UNSATISFIED [shape=box,label="INTERACTION_UNSATISFIED!"];
  INTERACTION_UNSATISFIED -> PROOF_JUSTIFY [label=" j "];
  INTERACTION_UNSATISFIED -> PROOF_INPUT_OR_JUSTIFY [label=" i ",color=invis,fontcolor=invis];
  INTERACTION_UNSATISFIED -> PROOF_QUERY_OR_JUSTIFY [label=" q ",color=invis,fontsize=20,fontcolor=invis];
  INTERACTION_UNSATISFIED -> PROOF_JUSTIFY_AND_END [label=" $ ",color=invis,fontcolor=invis];

  PROOF_VALUES_AND_END [color=invis,fontcolor=invis]
  PROOF_VALUES_AND_END -> "end-of-file" [label=" v ",color=invis,fontsize=20,fontcolor=invis];
  PROOF_JUSTIFY_AND_END [color=invis,fontcolor=invis]
  PROOF_JUSTIFY_AND_END -> "end-of-file" [label=" j ",color=invis,fontsize=20,fontcolor=invis];

  PROOF_VALUES -> INTERACTION_INPUT [label=" v ",color=darkgreen,fontsize=20,fontcolor=darkgreen];
  PROOF_JUSTIFY -> INTERACTION_INPUT [label=" j ",color=darkgreen,fontsize=20,fontcolor=darkgreen];

  PROOF_INPUT_OR_VALUES [color=invis,fontcolor=invis];
  PROOF_INPUT_OR_VALUES -> INTERACTION_INPUT [label=" i ",color=invis,fontcolor=invis];
  PROOF_INPUT_OR_VALUES -> PROOF_INPUT [label=" v ", color=invis,fontcolor=invis,fontsize=20];

  PROOF_QUERY_OR_VALUES [color=invis,fontcolor=invis];
  PROOF_QUERY_OR_VALUES -> PROOF_QUERY [label=" v ",color=invis,fontcolor=invis,fontsize=20];
  PROOF_QUERY_OR_VALUES -> PROOF_CHECK [label=" q ",color=invis,fontcolor=invis];

  PROOF_QUERY_OR_JUSTIFY [color=invis,fontcolor=invis];
  PROOF_QUERY_OR_JUSTIFY -> PROOF_QUERY [label=" j ",color=invis,fontcolor=invis,fontsize=20];
  PROOF_QUERY_OR_JUSTIFY -> PROOF_CHECK [label=" q ",color=invis,fontcolor=invis];

  PROOF_INPUT_OR_JUSTIFY [color=invis,fontcolor=invis];
  PROOF_INPUT_OR_JUSTIFY -> PROOF_INPUT [label=" j ",color=invis,fontcolor=invis,fontsize=20];
  PROOF_INPUT_OR_JUSTIFY -> INTERACTION_INPUT [label=" i ",color=invis,fontcolor=invis];
}
